




- name: Set up Kubeconfig for AKS
  run: |
    echo "📁 Creating ~/.kube directory"
    mkdir -p ~/.kube

    echo "🔐 Decoding kubeconfig and writing to ~/.kube/config"
    echo "${{ steps.terraform_outputs.outputs.AKS_KUBECFG }}" | base64 -d > ~/.kube/config

    echo "🔒 Securing config file permissions"
    chmod 600 ~/.kube/config

    echo "✅ kubeconfig is in place"