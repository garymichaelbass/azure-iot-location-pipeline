# azure-iot-location-monitoring\terraform\modules\databricks\notebook.py

# ... (rest of your notebook.py) ...

# Read streaming data from Azure Event Hubs.
try:
    spark
except NameError:
    from pyspark.sql import SparkSession
    spark = SparkSession.builder.getOrCreate()

    print("ðŸš€ Spark session ready. Reading from Event Hub...")
    
raw_df = spark.readStream \
    .format("org.apache.spark.sql.eventhubs.EventHubsSourceProvider") \ # <-- CHANGE THIS LINE
    .options(**ehConf) \
    .load()

print("âœ… Successfully connected to Event Hub.")

# ... (rest of your notebook.py) ...