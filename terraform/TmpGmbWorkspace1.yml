# azure-iot-location-monitoring\terraform\modules\databricks\main.tf

# ... (rest of your cluster definition) ...

resource "databricks_cluster" "iot_cluster" {
  cluster_name            = "iot-location-cluster"
  spark_version           = data.databricks_spark_version.latest_lts.id # '15.4.x-scala2.12' (Spark 3.5.0)
  node_type_id            = "Standard_DS3_v2"
  autotermination_minutes = 30
  num_workers             = 1

  # --- UPDATED EVENT HUBS CONNECTOR COORDINATE ---
  library {
    maven {
      # Use this coordinate: It's specifically for Spark 3.x and often has better compatibility.
      # Verify it on https://mvnrepository.com/artifact/com.azure.spark:azure-spark-eventhubs_2.12
      coordinates = "com.azure.spark:azure-spark-eventhubs_2.12:1.0.0" # A common, robust choice for Spark 3.x
    }
  }

  # --- Cosmos DB Connector (keep as is for now, fix one at a time) ---
  library {
    maven {
      coordinates = "com.azure.cosmos.spark:azure-cosmos-spark_3-1_2-12:4.19.1"
    }
  }
  # --- END Cosmos DB CONNECTOR ---

  # ... (rest of your cluster config) ...
}