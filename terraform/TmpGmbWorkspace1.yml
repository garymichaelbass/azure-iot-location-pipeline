import base64

eventhub_connection_string_b64 = dbutils.widgets.get("eventhub_connection_string_base64").strip()

try:
    eventhub_connection_string = base64.b64decode(eventhub_connection_string_b64).decode("utf-8")
    if not eventhub_connection_string.startswith("Endpoint="):
        raise ValueError("Decoded Event Hub string doesn't appear valid.")
except Exception as e:
    raise ValueError("‚ùå Failed to decode base64 Event Hub connection string.") from e

ehConf = {
    'eventhubs.connectionString': eventhub_connection_string
}
